# ==================== 全局基础设置 ====================
mixed-port: 7890
allow-lan: true                  # 局域网设备需要访问面板时保持 true
mode: rule
log-level: info
external-controller: 0.0.0.0:9090
secret: ""                       # 需要面板密码时填写

# ==================== 策略组 ====================
proxy-groups:
  - name: 选择代理
    type: select
    icon: https://cdn.jsdmirror.com/gh/Koolson/Qure@master/IconSet/Color/Proxy.png
    proxies:
      - 自动选择
      - 手动选择
      - DIRECT

  - name: 默认
    type: select
    icon: https://cdn.jsdmirror.com/gh/Koolson/Qure@master/IconSet/Color/Final.png
    proxies:
      - 选择代理
      - DIRECT

  - name: 自动选择
    type: url-test
    include-all-proxies: true       # ← 自动包含所有节点，名字随便改都没事
    icon: https://cdn.jsdmirror.com/gh/Koolson/Qure@master/IconSet/Color/Auto.png
    url: http://www.gstatic.com/generate_204
    interval: 300
    tolerance: 50

  - name: 手动选择
    type: select
    include-all-proxies: true       # ← 同上，所有节点自动显示
    icon: https://cdn.jsdmirror.com/gh/Koolson/Qure@master/IconSet/Color/Static.png
  
  - name: Google 分流
    icon: https://cdn.jsdmirror.com/gh/Koolson/Qure@master/IconSet/Color/Google_Search.png
    type: select 
    proxies: 
      - 选择代理

  - name: 直连分流
    icon: https://cdn.jsdmirror.com/gh/Koolson/Qure@master/IconSet/Color/Available_1.png
    type: select
    proxies:
      - DIRECT      

  - name: 广告拦截
    type: select
    icon: https://cdn.jsdmirror.com/gh/Koolson/Qure@master/IconSet/Color/Hijacking.png
    proxies:
      - REJECT

# ==================== 规则集 ====================
rule-providers:
  AWAvenue-Ads-Rule:
    type: http
    behavior: classical
    url: https://cdn.jsdmirror.com/gh/TG-Twilight/AWAvenue-Ads-Rule@main/Filters/AWAvenue-Ads-Rule-Clash-Classical.yaml
    path: ./rules/AWAvenue-Ads-Rule.yaml
    interval: 86400

  Google:
    type: http
    url: "https://cnb.cool/xiyingruyi/Stash-rules/-/git/raw/main/Google.yaml" # Google 服务规则集链接
    behavior: classical
    interval: 86400
    path: ./rules/Google.yaml

  Direct_Rules:
    type: http  
    url: "https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/China/China_Classical.yaml" # 强制直连规则集链接
    behavior: classical
    path: ./rules/Direct_Rules.yaml
    interval: 86400
    format: yaml

# ==================== 规则 ====================
rules:
  - PROCESS-NAME,v2ray,DIRECT
  - PROCESS-NAME,Surge,DIRECT
  - PROCESS-NAME,Clash,DIRECT
  - PROCESS-NAME,ClashMeta,DIRECT
  - PROCESS-NAME,mihomo,DIRECT
  - PROCESS-NAME,trojan,DIRECT
  - RULE-SET,AWAvenue-Ads-Rule,广告拦截
  - IP-CIDR,107.172.252.29/32,DIRECT,no-resolve
  - DOMAIN-SUFFIX,iphone-ld.apple.com,DIRECT
  - DOMAIN-SUFFIX,lcdn-locator.apple.com,DIRECT
  - DOMAIN-SUFFIX,lcdn-registration.apple.com,DIRECT
  - DOMAIN-SUFFIX,push.apple.com,DIRECT
  - GEOSITE,microsoft@cn,DIRECT
  - GEOSITE,steam@cn,DIRECT
  - PROCESS-NAME,BaiduNetdisk,DIRECT
  - PROCESS-NAME,Aliyundrive.exe,DIRECT
  - PROCESS-NAME,Quark,DIRECT
  - PROCESS-NAME,Thunder.exe,DIRECT
  - PROCESS-NAME,NetEaseMusic,DIRECT
  - PROCESS-NAME,QQMusic,DIRECT
  - GEOIP,LAN,DIRECT
  - GEOIP,CN,DIRECT,no-resolve
  - IP-CIDR,192.168.1.0/24,DIRECT
  - RULE-SET,Direct_Rules,直连分流,no-resolve # 引用外部直连规则集，走 '直连分流' 组  
  - RULE-SET,Google,Google 分流 # 引用外部规则集，匹配的域名走 'Google' 组 
  - GEOSITE,youtube,选择代理
  - DOMAIN-SUFFIX,vk.com,选择代理
  - MATCH,默认

dns:
  enable: true
  listen: 0.0.0.0:53
  ipv6: true  # 必须开启，支持双栈

  # 国内 DNS：解析国内网站，延迟低、稳定
  nameserver:
    - 223.5.5.5
    - 223.6.6.6
    - 114.114.114.114

  # 国外 DNS（DoH）：解析国外域名，干净可靠
  # 建议通过代理访问，避免国内网络阻断
    - https://1.1.1.1/dns-query
    - https://dns.google/dns-query

  # 系统 DNS 兜底：极端情况备用
  default-nameserver:
    - system
